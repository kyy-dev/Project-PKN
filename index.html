<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>NusantaraEdu Supreme - Ky Dev</title>

    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Space+Grotesk:wght@300;500;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-green: #2d6a4f;
            --mid-green: #52b788;
            --light-green: #d8f3dc;
            --cream: #fefae0;
            --orange-accent: #f3722c;
            --dark-bg: #0b120e;
            --dark-card: #161e19;
            --text-dark: #1b4332;
            --text-light: #f8f9fa;
            --glass: rgba(255, 255, 255, 0.8);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body { 
            font-family: 'Space Grotesk', sans-serif; 
            background-color: var(--cream); 
            color: var(--text-dark); 
            transition: background 0.4s, color 0.4s;
            overflow-x: hidden;
            min-height: 100vh;
        }

        body.dark-mode { 
            background-color: var(--dark-bg); 
            color: var(--text-light); 
            --glass: rgba(22, 30, 25, 0.9);
        }

        /* --- PRELOADER --- */
        #preloader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--primary-green);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 99999; transition: 0.8s cubic-bezier(0.77, 0, 0.175, 1);
        }
        .load-logo { font-family: 'Fredoka'; color: white; font-size: 2.2rem; margin-bottom: 20px; animation: pulse 1.5s infinite; }
        .load-bar { width: 180px; height: 4px; background: rgba(255,255,255,0.2); border-radius: 10px; overflow: hidden; }
        .load-progress { width: 0%; height: 100%; background: var(--orange-accent); animation: progress 2.2s ease forwards; }
        @keyframes pulse { 0% { opacity: 0.6; transform: scale(0.95); } 50% { opacity: 1; transform: scale(1); } 100% { opacity: 0.6; transform: scale(0.95); } }
        @keyframes progress { to { width: 100%; } }

        /* --- NOTIFIKASI --- */
        #customAlert {
            position: fixed; top: -100px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 450px; background: var(--glass); backdrop-filter: blur(15px);
            padding: 15px 20px; border-radius: 30px; box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            display: flex; align-items: center; gap: 15px; z-index: 100000;
            transition: 0.7s cubic-bezier(0.68, -0.6, 0.32, 1.6);
            border: 1px solid rgba(255,255,255,0.1);
        }
        #customAlert.active { top: 20px; }

        /* --- NAVBAR --- */
        .navbar {
            position: fixed; top: 0; left: 0; width: 100%;
            padding: 15px 5%;
            display: flex; justify-content: space-between; align-items: center;
            z-index: 1000; transition: 0.4s;
        }
        .navbar.scrolled { background: var(--glass); backdrop-filter: blur(10px); box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
        .logo { font-family: 'Fredoka'; font-weight: 600; font-size: 1.4rem; color: var(--primary-green); user-select: none; }
        body.dark-mode .logo { color: var(--mid-green); }
        .menu-btn { background: var(--primary-green); color: white; border: none; width: 45px; height: 45px; border-radius: 15px; cursor: pointer; display: grid; place-items: center; }

        .side-menu {
            position: fixed; top: 0; right: -100%; width: 300px; height: 100%;
            background: var(--glass); backdrop-filter: blur(25px); z-index: 10001;
            transition: 0.5s cubic-bezier(0.77, 0, 0.175, 1); padding: 80px 25px;
            box-shadow: -10px 0 30px rgba(0,0,0,0.1); overflow-y: auto;
        }
        .side-menu.active { right: 0; }
        .menu-item { 
            padding: 14px 18px; border-radius: 16px; margin-bottom: 10px; 
            display: flex; align-items: center; gap: 12px; cursor: pointer;
            transition: 0.3s; font-weight: 600; text-decoration: none; color: inherit;
            background: rgba(255,255,255,0.3); border: 1px solid rgba(0,0,0,0.05);
        }
        .menu-item:hover { background: var(--mid-green); color: white; }

        /* --- SEARCH & TAGS --- */
        .search-area { padding: 130px 20px 20px; text-align: center; }
        .search-wrapper { 
            display: flex; background: white; border-radius: 50px; padding: 6px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.05); max-width: 600px; margin: auto;
        }
        body.dark-mode .search-wrapper { background: var(--dark-card); }
        .search-bar { flex: 1; border: none; padding: 0 20px; outline: none; background: transparent; color: inherit; font-size: 16px; }

        .tag-container { display: flex; overflow-x: auto; gap: 10px; padding: 20px 5%; scrollbar-width: none; }
        .tag-container::-webkit-scrollbar { display: none; }
        .tag { white-space: nowrap; padding: 10px 25px; background: white; border-radius: 50px; font-size: 0.85rem; transition: 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.02); cursor: pointer; }
        body.dark-mode .tag { background: var(--dark-card); }
        .tag.active { background: var(--primary-green); color: white; }

        /* --- GRID & CARDS --- */
        .container { padding: 0 20px 100px; max-width: 1200px; margin: auto; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .card { 
            background: white; border-radius: 28px; overflow: hidden; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.03); transition: 0.4s;
            animation: slideIn 0.6s ease-out forwards;
        }
        body.dark-mode .card { background: var(--dark-card); }
        .card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        @keyframes slideIn { from { transform: translateY(40px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* Organisasi Section */
        .org-section {
            background: var(--primary-green); color: white;
            padding: 35px 25px; border-radius: 35px; margin-bottom: 30px; text-align: center;
        }
        .org-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px; }
        .org-card { 
            background: rgba(255,255,255,0.1); padding: 15px; border-radius: 20px; 
            text-decoration: none; color: white; border: 1px solid rgba(255,255,255,0.1); transition: 0.3s;
            font-size: 0.9rem; font-weight: 500;
        }
        .org-card:hover { background: rgba(255,255,255,0.2); transform: scale(1.03); }

        /* --- MODAL --- */
        .overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.85); backdrop-filter: blur(10px);
            display: none; justify-content: center; align-items: center; z-index: 100000;
        }
        .overlay.active { display: flex; }
        .modal-content { 
            background: var(--cream); padding: 35px 25px; border-radius: 35px; text-align: center;
            width: 92%; max-width: 420px; max-height: 85vh; overflow-y: auto;
        }
        body.dark-mode .modal-content { background: var(--dark-card); }

        .support-link {
            display: flex; align-items: center; gap: 15px; background: white;
            padding: 12px 20px; border-radius: 18px; margin-bottom: 10px;
            text-decoration: none; color: var(--text-dark); font-weight: bold;
            transition: 0.3s; border: 1px solid #eee;
        }
        body.dark-mode .support-link { background: #1f2923; color: white; border-color: #333; }

        footer { padding: 60px 20px; text-align: center; background: var(--primary-green); color: white; border-radius: 50px 50px 0 0; margin-top: 50px; }

        .leaf {
    position: fixed;
    top: -50px;
    z-index: 9999;
    pointer-events: none;
    animation: fall linear forwards;
}

@keyframes fall {
    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
}

.badge-new {
    background: var(--orange-accent);
    color: white;
    font-size: 0.6rem;
    padding: 2px 8px;
    border-radius: 10px;
    margin-left: auto;
    animation: pulse 1s infinite;
}

.card-actions {
    display: flex;
    gap: 10px;
    margin-top: 15px;
    padding-top: 15px;
    border-top: 1px dashed #eee;
}
.btn-action {
    flex: 1;
    padding: 8px;
    border-radius: 12px;
    border: none;
    font-size: 0.7rem;
    cursor: pointer;
    font-weight: bold;
    transition: 0.3s;
}
.btn-copy { background: var(--light-green); color: var(--primary-green); }
.btn-share { background: var(--orange-accent); color: white; }
.btn-action:active { transform: scale(0.9); }

.recommendation-section {
    padding: 20px 0;
    margin-bottom: 30px;
}
.rec-title {
    font-family: 'Fredoka';
    color: var(--primary-green);
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 10px;
}
.rec-grid {
    display: flex;
    overflow-x: auto;
    gap: 15px;
    padding-bottom: 10px;
    scrollbar-width: none; /* Hide scrollbar Firefox */
}
.rec-grid::-webkit-scrollbar { display: none; } /* Hide scrollbar Chrome/Safari */

.rec-card {
    min-width: 240px;
    background: white;
    border-radius: 20px;
    padding: 10px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.05);
    border: 1px solid rgba(0,0,0,0.05);
}
body.dark-mode .rec-card { background: var(--dark-card); border-color: #333; }

.rec-img {
    width: 100%;
    height: 120px;
    border-radius: 15px;
    object-fit: cover;
}
.rec-info h4 { font-size: 0.9rem; margin-top: 10px; color: var(--primary-green); }
.rec-info p { font-size: 0.7rem; opacity: 0.7; margin-top: 4px; }
.btn-visit {
    display: block;
    margin-top: 10px;
    padding: 8px;
    background: var(--light-green);
    color: var(--primary-green);
    text-align: center;
    border-radius: 10px;
    font-size: 0.7rem;
    font-weight: bold;
    text-decoration: none;
}
    </style>
</head>
<body>

    <div id="preloader">
        <div class="load-logo">üáÆüá© NusantaraEdu</div>
        <div class="load-bar"><div class="load-progress"></div></div>
        <p style="color: white; margin-top: 15px; font-size: 0.8rem; letter-spacing: 2px;">BY KY DEV</p>
    </div>

    <div id="customAlert">
        <div id="alertIcon" style="font-size: 1.8rem;">‚ú®</div>
        <div>
            <strong id="alertTitle" style="display:block; font-size: 0.9rem;">Sistem</strong>
            <div id="alertMsg" style="font-size: 0.8rem; opacity: 0.8;">Website siap!</div>
        </div>
    </div>

    <div class="side-menu" id="sideMenu">
        <h2 style="font-family: 'Fredoka'; margin-bottom: 25px; color: var(--primary-green);">Nusantara Menu</h2>
        <div class="menu-item" onclick="toggleDarkMode()">üåì Mode Tampilan</div>
        <div class="menu-item" onclick="showOrgModal()">üö© Gabung Organisasi</div>
        <div class="menu-item" onclick="showSupport()">ü§ù Support Dev</div>
        <div class="menu-item" onclick="reportBug()">üêú Lapor Kendala</div>
        <hr style="margin: 20px 0; opacity: 0.1;">
        <a href="https://github.com/ky-dev2" target="_blank" class="menu-item">üêô GitHub Profile</a>
        <div class="menu-item" onclick="showSekolah()">
    üè´ Tentang Sekolahku <span class="badge-new">NEW</span>
</div>


        <button onclick="toggleMenu()" style="background:var(--orange-accent); color:white; border:none; padding:14px; width:100%; border-radius:18px; margin-top:30px; font-weight:bold; cursor:pointer;">Tutup</button>
    </div>

    <nav class="navbar" id="mainNav">
        <div class="logo">üáÆüá© NusantaraEdu</div>
        <button class="menu-btn" onclick="toggleMenu()">‚ò∞</button>
    </nav>

    <div class="search-area">
        <h1 style="font-family:'Fredoka'; color:var(--primary-green); margin-bottom:15px;">Eksplorasi Budaya</h1>
        <div class="search-wrapper">
            <input type="text" id="userInput" class="search-bar" placeholder="Cari: Wayang, Rendang, Batik...">
            <button onclick="searchCulture()" style="background:var(--orange-accent); color:white; border:none; width:45px; height:45px; border-radius:50%; cursor:pointer;">üîç</button>
        </div>
    </div>

    <div class="tag-container">
        <div class="tag active" onclick="updateCategory('acak', this)">üè† Beranda</div>
        <div class="tag" onclick="updateCategory('Seni', this)">üé® Seni Budaya</div>
        <div class="tag" onclick="updateCategory('Kuliner', this)">üç≤ Kuliner</div>
        <div class="tag" onclick="updateCategory('Tempat', this)">üèõÔ∏è Wisata</div>
    </div>

    <main class="container">
        <div class="org-section">
            <h2 style="font-family:'Fredoka'; margin-bottom: 10px;">Ayo Lestarikan Budaya!</h2>
            <p style="font-size: 0.85rem; opacity: 0.9; margin-bottom: 20px;">Kunjungi situs resmi pemerintah untuk informasi lebih dalam.</p>
            <div class="org-grid">
                <a href="https://iha.kemenbud.go.id/" target="_blank" class="org-card">üèõÔ∏è Indonesia Heritage Agency</a>
                <a href="https://indonesia.go.id/kategori/budaya" target="_blank" class="org-card">üé≠ Portal Budaya Indonesia</a>
                <a href="https://warisanbudaya.kemdikbud.go.id/" target="_blank" class="org-card">üìú Warisan Budaya Takbenda</a>
            </div>
        </div>

        <div class="grid" id="contentGrid"></div>
        <div id="scrollStatus" style="text-align:center; padding:30px; display:none; color:var(--mid-green);">üåø Menjelajah lebih dalam...</div>
    </main>

    <div class="overlay" id="modalOverlay">  
        <div class="modal-content">  
            <h2 id="modalTitle" style="font-family: 'Fredoka'; color: var(--primary-green); margin-bottom: 20px;">Info</h2>  
            <div id="modalBody"></div>
            <button onclick="closeModal()" style="background: var(--primary-green); color: white; border: none; padding: 14px; border-radius: 50px; font-weight: bold; width: 100%; margin-top: 20px; cursor:pointer;">Tutup</button>  
        </div>  
    </div>

    <footer>
        <p style="font-family: 'Fredoka'; font-size: 1.3rem;">Fadhillah Dzaki Nasrullah</p>
        <p style="font-size: 0.75rem; margin-top: 8px; opacity: 0.7;">Project Edukasi PKN - SMP 2 Cawas</p>
    </footer>

    <script>
      const kalenderBudaya = [
    { "tgl": "01-01", "event": "Tahun Baru & Semangat Budaya", "pesan": "Awali tahun dengan semangat melestarikan budaya Nusantara!" },
    { "tgl": "02-21", "event": "Hari Bahasa Ibu Internasional", "pesan": "Jangan lupa gunakan bahasa daerahmu hari ini! üó£Ô∏è" },
    { "tgl": "03-09", "event": "Hari Musik Nasional", "pesan": "Ayo dengarkan instrumen tradisional seperti Angklung atau Gamelan! üé∂" },
    { "tgl": "04-21", "event": "Hari Kartini", "pesan": "Habis Gelap Terbitlah Terang. Mari teladani perjuangan Ibu Kartini. üëó" },
    { "tgl": "05-02", "event": "Hari Pendidikan Nasional", "pesan": "Ing Ngarsa Sung Tuladha. Semangat belajar untuk masa depan! üìö" },
    { "tgl": "06-01", "event": "Hari Lahir Pancasila", "pesan": "Pancasila adalah pemersatu keberagaman budaya kita. üáÆüá©" },
    { "tgl": "08-17", "event": "Hari Kemerdekaan RI", "pesan": "Merdeka! Rayakan kemerdekaan dengan bangga akan budaya sendiri!" },
    { "tgl": "10-02", "event": "Hari Batik Nasional", "pesan": "Selamat Hari Batik! Warisan dunia dari Indonesia untuk jagat raya. üëî" },
    { "tgl": "10-28", "event": "Hari Sumpah Pemuda", "pesan": "Satu nusa, satu bangsa, satu bahasa. Salam pemuda! ‚úä" },
    { "tgl": "11-07", "event": "Hari Wayang Nasional", "pesan": "Mari apresiasi mahakarya seni pertunjukan wayang hari ini. üë∫" },
    { "tgl": "11-10", "event": "Hari Pahlawan", "pesan": "Bangsa yang besar adalah bangsa yang menghargai jasa pahlawannya. üéñÔ∏è" },
    { "tgl": "12-22", "event": "Hari Ibu", "pesan": "Terima kasih untuk seluruh Ibu yang melestarikan budaya di rumah. ‚ù§Ô∏è" }
];

function cekEventHariIni() {
    const sekarang = new Date();
    // Format tanggal ke MM-DD agar sesuai dengan JSON
    const bulan = String(sekarang.getMonth() + 1).padStart(2, '0');
    const tanggal = String(sekarang.getDate()).padStart(2, '0');
    const tglKey = `${bulan}-${tanggal}`;

    // Cari apakah hari ini ada di kalender
    const temukanEvent = kalenderBudaya.find(e => e.tgl === tglKey);

    if (temukanEvent) {
        // Tunggu sebentar setelah preloader selesai, lalu munculkan modal
        setTimeout(() => {
            document.getElementById('modalTitle').innerText = `‚ú® ${temukanEvent.event}`;
            document.getElementById('modalBody').innerHTML = `
                <div style="background: var(--light-green); padding: 25px; border-radius: 20px; color: var(--primary-green); text-align: center;">
                    <h1 style="font-size: 3rem; margin-bottom: 10px;">üáÆüá©</h1>
                    <p style="font-weight: 600; line-height: 1.6;">${temukanEvent.pesan}</p>
                </div>
                <p style="font-size: 0.7rem; margin-top: 15px; opacity: 0.6;">Sistem Kalender Otomatis NusantaraEdu</p>
            `;
            document.getElementById('modalOverlay').classList.add('active');
            showNotif("Event Khusus", temukanEvent.event, "üéâ");
        }, 2000); 
    }
}

      
        const grid = document.getElementById('contentGrid');
        const searchInput = document.getElementById('userInput');

        // --- DATASET FAKTA UNIK (Generator 2000+ Variasi) ---
        const faktaSubjek = ["Candi Borobudur", "Rendang", "Bahasa Indonesia", "Komodo", "Wayang Kulit", "Angklung", "Batik", "Danau Toba", "Gamelan", "Kopi Luwak", "Burung Cendrawasih", "Pulau Jawa", "Suku Buton", "Raja Ampat", "Pencak Silat", "Tari Saman", "Kapal Phinisi", "Garis Khatulistiwa", "Gunung Jayawijaya", "Naskah Negarakertagama"];
        const faktaPredikat = ["adalah yang terbesar di dunia", "telah diakui oleh UNESCO", "memiliki sejarah lebih dari 1000 tahun", "menjadi simbol kebanggaan nasional", "merupakan warisan takbenda kemanusiaan", "hanya bisa ditemukan di bumi nusantara", "pernah dinobatkan sebagai yang terbaik secara global", "menginspirasi banyak kebudayaan di negara lain", "menyimpan misteri geologi yang luar biasa", "menjadi bukti kecerdasan nenek moyang kita"];
        const faktaObjek = ["dalam kategori warisan budaya.", "sebagai identitas bangsa Indonesia.", "yang menarik perhatian peneliti dunia.", "sejak puluhan dekade yang lalu.", "menurut catatan sejarah internasional.", "bagi kelestarian alam nusantara.", "di tengah perkembangan era modern.", "yang wajib kita jaga bersama.", "di bawah naungan hukum internasional.", "sebagai pilar pariwisata kita."];

                // --- DATASET MASSIVE (100+ PER KATEGORI) ---
        const collections = {
            acak: [
                "Wayang", "Batik", "Borobudur", "Rendang", "Angklung", "Pencak_Silat", "Keris", "Gamelan", "Soto", "Nasi_Goreng",
                "Prambanan", "Danau_Toba", "Raja_Ampat", "Tari_Saman", "Reog", "Kain_Ulos", "Kujang", "Rumah_Gadang", "Lurik",
                "Kopi_Luwak", "Tari_Kecak", "Tari_Piring", "Papeda", "Pempek", "Gudeg", "Lawang_Sewu", "Candi_Cetho", "Sasando",
                "Kolintang", "Tifa", "Rumah_Limas", "Joglo", "Tongkonan", "Honai", "Mandau", "Badik", "Rencong", "Tari_Barong",
                "Sate_Madura", "Bakso", "Rawon", "Opor_Ayam", "Nasi_Liwet", "Ayam_Betutu", "Es_Dawet", "Wingko_Babat", "Serabi",
                "Kue_Putu", "Klepon", "Bika_Ambon", "Tari_Jaipong", "Tari_Merak", "Seni_Ukir_Jepara", "Ondel-ondel", "Sisingaan",
                "Ketoprak", "Ludruk", "Lenong", "Wayang_Golek", "Wayang_Beber", "Gong", "Kenong", "Bonang", "Kendang", "Rebab",
                "Saron", "Siter", "Celempung", "Calung", "Bedug", "Tari_Tor-tor", "Tari_Gandrung", "Tari_Topeng", "Tari_Serimpi",
                "Tari_Bedhaya", "Tari_Baksa_Kembang", "Tari_Zapin", "Tari_Merak", "Tari_Sajojo", "Tari_Maengket", "Tari_Gambyong",
                "Tari_Pendet", "Tari_Legong", "Tari_Cakalele", "Tari_Gambo", "Sapeh", "Kledi", "Karinding", "Talempong", "Saluang",
                "Kecapi", "Suling", "Gambus", "Tehyan", "Batik_Solo", "Batik_Pekalongan", "Batik_Parang", "Batik_Megamendung",
                "Songket", "Kain_Tapis", "Kain_Tenun_Sumba", "Garis_Khatulistiwa", "Gunung_Bromo", "Kawah_Ijen", "Pulau_Komodo",
                "Taman_Mini_Indonesia_Indah", "Monumen_Nasional", "Museum_Nasional_Indonesia", "Benteng_Rotterdam", "Benteng_Vredeburg",
                "Istana_Maimun", "Keraton_Ngayogyakarta_Hadiningrat", "Keraton_Surakarta", "Masjid_Menara_Kudus", "Masjid_Raya_Baiturrahman",
                "Wae_Rebo", "Tana_Toraja", "Sangiran", "Pura_Besakih", "Tanah_Lot", "Bunaken", "Kepulauan_Derawan", "Danau_Kelimutu",
                "Gunung_Rinjani", "Pantai_Pandawa", "Candi_Sukuh", "Candi_Sewu", "Candi_Kalasan", "Benteng_Marlborough", "Lumpia_Semarang",
                "Tahu_Sumedang", "Mie_Aceh", "Coto_Makassar", "Es_Pisang_Ijo", "Bubur_Manado", "Kapurung", "Rujak_Cingur", "Kerak_Telor",
                "Nasi_Uduk", "Nasi_Kuning", "Sate_Lilit", "Gulai_Pakis", "Kue_Lumpur", "Lapis_Legit", "Martabak_Manis", "Soto_Lamongan"
            ],
            Seni: [
                "Wayang_Kulit", "Batik", "Angklung", "Pencak_Silat", "Keris", "Gamelan", "Tari_Saman", "Reog_Ponorogo", "Kain_Ulos",
                "Tari_Kecak", "Tari_Piring", "Sasando", "Kolintang", "Tifa", "Tari_Barong", "Tari_Jaipong", "Tari_Merak",
                "Seni_Ukir_Jepara", "Ondel-ondel", "Sisingaan", "Ketoprak", "Ludruk", "Lenong", "Wayang_Golek", "Wayang_Beber",
                "Gong", "Kenong", "Bonang", "Kendang", "Rebab", "Saron", "Siter", "Celempung", "Calung", "Bedug", "Tari_Tor-tor",
                "Tari_Gandrung", "Tari_Topeng", "Tari_Serimpi", "Tari_Bedhaya", "Tari_Baksa_Kembang", "Tari_Zapin", "Tari_Sajojo",
                "Tari_Maengket", "Tari_Gambyong", "Tari_Pendet", "Tari_Legong", "Tari_Cakalele", "Tari_Gambo", "Sapeh", "Kledi",
                "Karinding", "Talempong", "Saluang", "Kecapi", "Suling", "Gambus", "Tehyan", "Batik_Solo", "Batik_Pekalongan",
                "Batik_Parang", "Batik_Megamendung", "Songket", "Kain_Tapis", "Kain_Tenun_Sumba", "Kujang", "Mandau", "Badik",
                "Rencong", "Parang", "Celurit", "Kain_Ulos", "Lurik", "Sinden", "Macapat", "Debus", "Kuda_Lumping", "Tari_Topeng_Cirebon",
                "Seni_Lukis_Kamasan", "Ukir_Asmat", "Batik_Cirebon", "Tenun_Ikat", "Tari_Golek", "Wayang_Wong", "Tari_Piring",
                "Gamelan_Bali", "Gamelan_Sunda", "Gendang_Beleq", "Tari_Manyer_Sewu", "Tari_Piring", "Seni_Ukir_Bali", "Wayang_Sukur",
                "Tari_Bambu_Gila", "Tari_Pagar_Pengantin", "Seni_Ukir_Toraja", "Tari_Balean_Dadas", "Tari_Lilin", "Tari_Remo"
            ],
            Kuliner: [
                "Rendang", "Soto", "Nasi_Goreng", "Kopi_Luwak", "Papeda", "Pempek", "Gudeg", "Sate_Madura", "Bakso", "Rawon",
                "Opor_Ayam", "Nasi_Liwet", "Ayam_Betutu", "Es_Dawet", "Wingko_Babat", "Serabi", "Kue_Putu", "Klepon", "Bika_Ambon",
                "Lumpia_Semarang", "Tahu_Sumedang", "Mie_Aceh", "Coto_Makassar", "Es_Pisang_Ijo", "Bubur_Manado", "Kapurung",
                "Rujak_Cingur", "Kerak_Telor", "Nasi_Uduk", "Nasi_Kuning", "Sate_Lilit", "Gulai_Pakis", "Kue_Lumpur", "Lapis_Legit",
                "Martabak_Manis", "Soto_Lamongan", "Pecel_Lele", "Gado-gado", "Karedok", "Ketoprak_(makanan)", "Sayur_Asem",
                "Gulai_Kambing", "Sate_Padura", "Pindang_Patin", "Ayam_Taliwang", "Nasi_Padang", "Nasi_Ulam", "Bubur_Ayam",
                "Soto_Betawi", "Soto_Kudus", "Soto_Banjar", "Soto_Medan", "Mie_Kocok", "Mie_Cakalang", "Laksa", "Asinan_Bogor",
                "Tahu_Gejrot", "Seblak", "Batagor", "Siomay", "Cimol", "Cilor", "Kue_Cucur", "Kue_Balok", "Kue_Pancong", "Getuk",
                "Wajik", "Dodol_Garut", "Jenang", "Madumongso", "Tape_Singkong", "Peuyeum", "Roti_Buaya", "Binte_Biluhuta",
                "Pallubasa", "Konro", "Sop_Saudara", "Ikan_Bakar_Cianjur", "Ayam_Goreng_Kalasan", "Sate_Maranggi", "Sate_Kere",
                "Empal_Gentong", "Tahu_Campur", "Tahu_Tek", "Lontong_Kupang", "Nasi_Grombyang", "Nasi_Krawu", "Nasi_Pecel",
                "Ayam_Pop", "Dendeng_Balado", "Gulai_Otak", "Samba_Lado_Tanah", "Sate_Kajang", "Mie_Goreng_Jawa", "Bebek_Sinjay"
            ],
            Tempat: [
                "Borobudur", "Prambanan", "Danau_Toba", "Raja_Ampat", "Lawang_Sewu", "Candi_Cetho", "Rumah_Limas", "Joglo",
                "Tongkonan", "Honai", "Garis_Khatulistiwa", "Gunung_Bromo", "Kawah_Ijen", "Pulau_Komodo", "Taman_Mini_Indonesia_Indah",
                "Monumen_Nasional", "Museum_Nasional_Indonesia", "Benteng_Rotterdam", "Benteng_Vredeburg", "Istana_Maimun",
                "Keraton_Ngayogyakarta_Hadiningrat", "Keraton_Surakarta", "Masjid_Menara_Kudus", "Masjid_Raya_Baiturrahman",
                "Wae_Rebo", "Tana_Toraja", "Sangiran", "Pura_Besakih", "Tanah_Lot", "Bunaken", "Kepulauan_Derawan", "Danau_Kelimutu",
                "Gunung_Rinjani", "Pantai_Pandawa", "Candi_Sukuh", "Candi_Sewu", "Candi_Kalasan", "Benteng_Marlborough",
                "Benteng_Belgica", "Candi_Bala_Putra_Dewa", "Candi_Penataran", "Candi_Muara_Takus", "Taman_Nasional_Ujung_Kulon",
                "Taman_Nasional_Lore_Lindu", "Taman_Nasional_Lorentz", "Bukit_Lawang", "Kepulauan_Wakatobi", "Pulau_Weh",
                "Pantai_Ora", "Lembah_Harau", "Ngarai_Sianok", "Jam_Gadang", "Lubang_Buaya", "Gedung_Sate", "Jalan_Malioboro",
                "Pasar_Terapung", "Jembatan_Ampera", "Masjid_Istiqlal", "Gereja_Katedral_Jakarta", "Kelenteng_Sam_Poo_Kong",
                "Vihara_Avalokitesvara", "Istana_Bogor", "Istana_Cipanas", "Istana_Tampaksiring", "Taman_Sari_Yogyakarta",
                "Benteng_Speelwijk", "Benteng_Heritage", "Museum_Angkut", "Jatim_Park", "Taman_Safari_Indonesia", "Kawah_Putih",
                "Gunung_Tangkuban_Parahu", "Gunung_Merapi", "Gunung_Semeru", "Puncak_Jaya", "Pantai_Parangtritis", "Pantai_Kuta",
                "Pantai_Senggigi", "Gili_Trawangan", "Pulau_Samosir", "Banda_Neira", "Ternate", "Tidore", "Pulau_Bintan",
                "Pulau_Bangka", "Pulau_Belitung", "Pantai_Tanjung_Tinggi", "Danau_Sentani", "Danau_Singkarak", "Danau_Ranau"
            ]
        };

        const infiniteLibrary = [...collections.acak].sort(() => Math.random() - 0.5);


        let itemsLoaded = 0;
        let isFetching = false;
        let activeCategory = 'acak';

        // --- CORE FUNCTIONS ---
        function generateUniqueFact() {
            const s = faktaSubjek[Math.floor(Math.random() * faktaSubjek.length)];
            const p = faktaPredikat[Math.floor(Math.random() * faktaPredikat.length)];
            const o = faktaObjek[Math.floor(Math.random() * faktaObjek.length)];
            return `${s} ${p} ${o}`;
        }

        function showLoginFact() {
            const fact = generateUniqueFact();
            document.getElementById('modalTitle').innerText = "üí° Fakta Unik Hari Ini";
            document.getElementById('modalBody').innerHTML = `
                <div style="padding: 20px; background: var(--light-green); border-radius: 20px; color: var(--primary-green); font-weight: 500; line-height: 1.6;">
                    "${fact}"
                </div>
                <p style="margin-top: 15px; font-size: 0.75rem; opacity: 0.7;">Tahukah kamu? Indonesia memiliki ribuan cerita yang belum terungkap sepenuhnya.</p>
            `;
            document.getElementById('modalOverlay').classList.add('active');
        }

        function showNotif(title, msg, icon = "‚ú®") {
            const alertBox = document.getElementById('customAlert');
            document.getElementById('alertTitle').innerText = title;
            document.getElementById('alertMsg').innerText = msg;
            document.getElementById('alertIcon').innerText = icon;
            alertBox.classList.add('active');
            setTimeout(() => alertBox.classList.remove('active'), 3000);
        }

        function toggleMenu() { document.getElementById('sideMenu').classList.toggle('active'); }
        function closeModal() { document.getElementById('modalOverlay').classList.remove('active'); }

        async function fetchCulture(topic) {
    try {
        const res = await fetch(`https://id.wikipedia.org/api/rest_v1/page/summary/${topic}`);
        const data = await res.json();
        if (data.title === "Not found") return;

        const img = (data.thumbnail) ? data.thumbnail.source : `https://images.unsplash.com/photo-1555939594-58d7cb561ad1?auto=format&fit=crop&w=500&q=60`;
        const shortDesc = data.extract ? data.extract.substring(0, 95) + '...' : 'Warisan kekayaan budaya nusantara.';

        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <div style="position:relative; overflow:hidden;">
                <img src="${img}" style="width:100%; height:200px; object-fit:cover;">
            </div>
            <div style="padding:22px;">
                <h3 style="color:var(--primary-green); font-size:1.1rem; margin-bottom:8px;">${data.title}</h3>
                <p style="font-size:0.8rem; line-height:1.5; opacity:0.8;">${shortDesc}</p>
                <div class="card-actions">
                    <button class="btn-action btn-copy" onclick="copyFact('${data.title}', '${shortDesc.replace(/'/g, "\\'")}')">üìã Salin Info</button>
                    <button class="btn-action btn-share" onclick="shareWa('${data.title}')">üì≤ Share WA</button>
                </div>
                <a href="${data.content_urls.desktop.page}" target="_blank" style="display:block; text-align:center; margin-top:15px; color:var(--mid-green); font-weight:bold; font-size:0.7rem; text-decoration:none;">PELAJARI VIA WIKIPEDIA ‚Üí</a>
            </div>
        `;
        grid.appendChild(card);
    } catch (e) { console.log(e); }
}


        async function updateCategory(cat, el) {
            if (isFetching) return;
            document.querySelectorAll('.tag').forEach(t => t.classList.remove('active'));
            el.classList.add('active');
            grid.innerHTML = '';
            itemsLoaded = 0;
            activeCategory = cat;
            for (const item of collections[cat]) {
                await fetchCulture(item);
            }
        }

        function searchCulture() {
            const val = searchInput.value.trim();
            if(!val) return;
            grid.innerHTML = '';
            fetchCulture(val.replace(/ /g, '_'));
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            showNotif("Mode", "Tampilan diubah", "üåì");
        }

        function showSupport() {
            toggleMenu();
            document.getElementById('modalTitle').innerText = "Support Ky Dev";
            document.getElementById('modalBody').innerHTML = `
                <a href="https://instagram.com/kycihuyy1" target="_blank" class="support-link">üì∏ Instagram</a>
                                <a href="https://tiktok.com/@kysnku" target="_blank" class="support-link">üéµ TikTok</a>
                <a href="https://saweria.co/Kydev" target="_blank" class="support-link">‚òï Saweria</a>
            `;
            document.getElementById('modalOverlay').classList.add('active');
        }

        function showOrgModal() {
            toggleMenu();
            document.getElementById('modalTitle').innerText = "Organisasi Resmi";
            document.getElementById('modalBody').innerHTML = `<p>Kunjungi situs resmi: kemenbud.go.id</p>`;
            document.getElementById('modalOverlay').classList.add('active');
        }

        function reportBug() {
            toggleMenu();
            showNotif("Email", "hubungi fadhillahnasrullah9@gmail.com", "üìß");
        }

        // --- SCROLL & INITIAL ---
        window.addEventListener('scroll', () => {
            const nav = document.getElementById('mainNav');
            nav.classList.toggle('scrolled', window.scrollY > 50);

            if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 1000) {
                if(!isFetching && activeCategory === 'acak' && itemsLoaded < infiniteLibrary.length) {
                    isFetching = true;
                    document.getElementById('scrollStatus').style.display = 'block';
                    const loadBatch = async () => {
                        await fetchCulture(infiniteLibrary[itemsLoaded]);
                        itemsLoaded++;
                        isFetching = false;
                        document.getElementById('scrollStatus').style.display = 'none';
                    };
                    loadBatch();
                }
            }
        });

        window.onload = () => {
    setTimeout(async () => {
        // 1. Hilangkan Preloader
        document.getElementById('preloader').style.transform = 'translateY(-100%)';

        // 2. Logika Pengecekan Event Kalender
        const sekarang = new Date();
        const bulan = String(sekarang.getMonth() + 1).padStart(2, '0');
        const tanggal = String(sekarang.getDate()).padStart(2, '0');
        const tglKey = `${bulan}-${tanggal}`;
        const temukanEvent = kalenderBudaya.find(e => e.tgl === tglKey);

        // 3. Prioritas Tampilan Modal (Pilih salah satu agar tidak tumpang tindih)
        if (temukanEvent) {
            // Jika hari ini ada event besar, tampilkan event
            document.getElementById('modalTitle').innerText = `‚ú® ${temukanEvent.event}`;
            document.getElementById('modalBody').innerHTML = `
                <div style="background: var(--light-green); padding: 25px; border-radius: 20px; color: var(--primary-green); text-align: center;">
                    <h1 style="font-size: 3rem; margin-bottom: 10px;">üáÆüá©</h1>
                    <p style="font-weight: 600; line-height: 1.6;">${temukanEvent.pesan}</p>
                </div>
            `;
            document.getElementById('modalOverlay').classList.add('active');
        } else {
            // Jika tidak ada event, tampilkan Update Announcement atau Login Fact
            showUpdateAnnouncement(); 
        }

        // 4. Load Data Utama
        for (const item of collections.acak) {
            await fetchCulture(item);
        }

        // 5. Jalankan fitur tambahan otomatis
        if (typeof applySmartTheme === "function") applySmartTheme();
        
    }, 1500);
};


        searchInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') searchCulture(); });

        function createLeaf() {
    const leaf = document.createElement('div');
    leaf.className = 'leaf';
    leaf.innerHTML = 'üçÉ';
    leaf.style.left = Math.random() * 100 + 'vw';
    leaf.style.fontSize = (Math.random() * 20 + 10) + 'px';

    // Perbaikan: gunakan style.animationDuration
    const duration = Math.random() * 3 + 4; 
    leaf.style.animationDuration = duration + 's';

    leaf.style.opacity = Math.random();
    document.body.appendChild(leaf);

    // Hapus daun setelah animasi selesai agar tidak membebani memori
    setTimeout(() => leaf.remove(), duration * 1000);
}
// Jalankan fungsi daun
setInterval(createLeaf, 1500); 

async function updateCategory(cat, el) {
    // Jika sedang memuat kategori yang sama, abaikan
    if (isFetching && activeCategory === cat) return;
    
    // Set status fetching
    isFetching = true; 

    // Visual feedback: Ubah tampilan tombol aktif
    document.querySelectorAll('.tag').forEach(t => t.classList.remove('active'));
    el.classList.add('active');

    // Reset konten
    grid.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 50px;">üåø Memuat kekayaan budaya...</div>';
    itemsLoaded = 0;
    activeCategory = cat;

    try {
        const batch = collections[cat];
        // Kosongkan grid sebelum mengisi dengan data baru
        grid.innerHTML = ''; 
        
        // Memuat 15 item pertama saja agar tidak macet/lambat (opsional)
        for (const item of batch) {
            // Jika pengguna sudah pindah kategori lain saat ini masih loading, hentikan proses ini
            if (activeCategory !== cat) break; 
            await fetchCulture(item);
        }
    } catch (error) {
        console.error("Gagal memuat kategori:", error);
    } finally {
        // PENTING: Kunci dibuka kembali agar tombol lain bisa dipencet
        isFetching = false; 
    }
}

function showSekolah() {
    toggleMenu();
    document.getElementById('modalTitle').innerText = "Profil Resmi Sekolah";
    document.getElementById('modalBody').innerHTML = `
        <div style="text-align:left; font-size:0.85rem; line-height:1.5;">
            <div style="background:var(--primary-green); color:white; padding:20px; border-radius:20px; margin-bottom:15px; text-align:center;">
                <h3 style="font-family:'Fredoka'; margin-bottom:5px;">SMP NEGERI 2 CAWAS</h3>
                <p style="font-size:0.75rem; opacity:0.9;">NPSN: 20309592 | Akreditasi: A</p>
            </div>
            
            <div style="background:var(--light-green); padding:15px; border-radius:15px; margin-bottom:15px; color:var(--text-dark);">
                <p>üìç <b>Alamat:</b> Gombang Rt 01 Rw 01, Kec. Cawas, Kab. Klaten, Jawa Tengah.</p>
                <p>üë®‚Äçüè´ <b>Kepala Sekolah:</b> Eko Widodo</p>
                <p>üìö <b>Kurikulum:</b> Kurikulum SMP Merdeka</p>
            </div>

            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:15px;">
                <div style="border:1px solid #ddd; padding:10px; border-radius:12px; text-align:center;">
                    <span style="display:block; font-size:1.2rem;">üë•</span>
                    <b>432</b><br>Total Siswa
                </div>
                <div style="border:1px solid #ddd; padding:10px; border-radius:12px; text-align:center;">
                    <span style="display:block; font-size:1.2rem;">üè¢</span>
                    <b>15</b><br>Rombel
                </div>
                <div style="border:1px solid #ddd; padding:10px; border-radius:12px; text-align:center;">
                    <span style="display:block; font-size:1.2rem;">üìñ</span>
                    <b>1</b><br>Perpustakaan
                </div>
                <div style="border:1px solid #ddd; padding:10px; border-radius:12px; text-align:center;">
                    <span style="display:block; font-size:1.2rem;">üß™</span>
                    <b>2</b><br>Laboratorium
                </div>
            </div>

            <p style="font-size:0.75rem; color:gray; text-align:center; font-style:italic;">
                "Sekolah Negeri dengan Luas Tanah 10.030 m¬≤ yang nyaman untuk belajar."
            </p>
            
            <a href="https://sekolah.data.kemendikdasmen.go.id/profil-sekolah/8034325A-2DF5-E011-ACC0-ADEF23297D2F" target="_blank" style="display:block; margin-top:15px; padding:12px; background:var(--orange-accent); color:white; text-decoration:none; border-radius:12px; font-weight:bold; text-align:center;">Cek Data Dapodik</a>
        </div>
    `;
    document.getElementById('modalOverlay').classList.add('active');
}

function showUpdateAnnouncement() {
    document.getElementById('modalTitle').innerText = "üöÄ UPDATE SUPREME V1.1";
    document.getElementById('modalBody').innerHTML = `
        <div style="text-align: left;">
            <div style="background: linear-gradient(135deg, #2d6a4f, #1b4332); color: white; padding: 18px; border-radius: 20px; margin-bottom: 20px; box-shadow: 0 10px 20px rgba(45, 106, 79, 0.2);">
                <h4 style="margin-bottom: 5px; display: flex; align-items: center; gap: 8px;">
                    Halo Patriot Budaya! üáÆüá©
                </h4>
                <p style="font-size: 0.75rem; opacity: 0.9;">Optimasi sistem telah selesai dilakukan untuk kenyamanan jelajahmu.</p>
            </div>

            <h5 style="color: var(--primary-green); margin-bottom: 10px; font-size: 0.9rem;">Log Perubahan:</h5>
            <ul style="font-size: 0.8rem; padding-left: 15px; line-height: 1.7; color: var(--text-dark);">
                <li><b>Fixed Bug:</b> Perbaikan pada sistem pencarian dan duplikasi kartu budaya.</li>
                <li><b>üì≤ Share ke WhatsApp:</b> Bagikan info budaya favoritmu langsung ke grup kelas atau teman!</li>
                <li><b>üìã Salin Info Cepat:</b> Copy deskripsi budaya dalam satu klik untuk tugas sekolah atau catatan.</li>
<li><b>üè´ Fitur Sekolah:</b> Profil resmi SMP Negeri 2 Cawas terintegrasi Dapodik.</li>
                <li><b>Max Performance:</b> Loading Wikipedia API kini 2x lebih cepat & ringan.</li>
                <li><b>Smart Calendar:</b> Sistem otomatis mendeteksi hari besar nasional.</li>
            </ul>

            <div style="margin-top: 20px; padding: 15px; background: #e7f3ef; border-radius: 15px; border: 1px dashed var(--primary-green); position: relative; overflow: hidden;">
                <div style="position: absolute; right: -10px; bottom: -10px; font-size: 3rem; opacity: 0.1;">üì±</div>
                <h6 style="color: var(--primary-green); margin-bottom: 5px; font-size: 0.85rem;">Coming Soon!</h6>
                <p style="font-size: 0.7rem; color: #2d6a4f; font-weight: 500;">
                    <b>NusantaraEdu Mobile App</b>
                </p>
            </div>

            <p style="font-size: 0.65rem; color: gray; text-align: center; margin-top: 15px; font-style: italic;">
                Dikembangkan dengan ‚ù§Ô∏è oleh Ky Dev
            </p>
        </div>
    `;
    document.getElementById('modalOverlay').classList.add('active');
}


// Tambahkan pemanggilan ini di dalam window.onload yang sudah ada
// Ganti bagian window.onload lama dengan ini:
window.onload = () => {
    setTimeout(async () => {
        document.getElementById('preloader').style.transform = 'translateY(-100%)';

        // Pemicu Pengumuman Update
        showUpdateAnnouncement(); 

        for (const item of collections.acak) {
            await fetchCulture(item);
        }
    }, 1500);
};

function copyFact(title, desc) {
    const text = `Tahukah kamu tentang ${title}? \n\n${desc}\n\nPelajari lebih lanjut di NusantaraEdu!`;
    navigator.clipboard.writeText(text);
    showNotif("Teks Disalin", "Info budaya siap dibagikan!", "‚úÖ");
}

function shareWa(title) {
    const url = `https://wa.me/?text=Halo! Cek budaya Indonesia yang keren ini: ${title}. Lihat selengkapnya di https://project-pkn.vercel.app/`;
    window.open(url, '_blank');
}


    </script>
</body>
</html>